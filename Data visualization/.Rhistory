mutate(string = c(12, 37, 24, 74)),
aes(x = m.x, y = m.y, label = string),
size = 6)
ggplot(gender_data) +
geom_mosaic(aes(weight=num, x=product(gender, label), fill=label)) +
theme_solarized() +
labs(x="", y="", fill="")
#mosaic plot
g1 <- ggplot(gender_data) +
geom_mosaic(aes(weight=num, x=product(gender, label), fill=label)) +
theme_solarized() +
labs(x="", y="", fill="")
g2 <- g1 + geom_text(data = layer_data(g1, 1) %>%
select(xmin:ymax) %>%
mutate(m.x = (xmin + xmax)/2, m.y =  (ymin + ymax)/2) %>%
select(m.x, m.y)  %>%
mutate(string = c(12, 37, 24, 74)),
aes(x = m.x, y = m.y, label = string),
size = 6)
ggplotly(g2)
#mosaic plot
g1 <- ggplot(gender_data) +
geom_mosaic(aes(weight=num, x=product(gender, label), fill=label)) +
theme_solarized() +
labs(x="", y="", fill="") +
ggtitle(laebl="성별에 따른 폐암 여부")
#mosaic plot
g1 <- ggplot(gender_data) +
geom_mosaic(aes(weight=num, x=product(gender, label), fill=label)) +
theme_solarized() +
labs(x="", y="", fill="") +
ggtitle(label="성별에 따른 폐암 여부")
g1
cancer
###2
period_cancer <- cancer %>%
filter(LC == "LungCancer") %>%
select(Smking) %>%
table() %>%
as.data.frame()
###2
period_cancer <- cancer %>%
filter(LC == "LungCancer") %>%
select(Smoking) %>%
table() %>%
as.data.frame()
period_cancer
period_no_cancer <- cancer %>%
filter(LC == "NoCancer") %>%
select(Smoking) %>%
table() %>%
as.data.frame()
names(period_cancer)[1] <- "period"
names(period_no_cancer)[1] <- "period"
names(period_cancer)[2] <- "num"
names(period_no_cancer)[2] <- "num"
###2
period_cancer <- cancer %>%
#filter(LC == "LungCancer") %>%
select(Smoking, LC) %>%
table() %>%
as.data.frame()
period_cancer
ggplot(data=period_cancer, aes(x=Freq, y=Smoking, fill=LC)) + geom_violin()
str(period_no_cancer)
str(period_cancer)
period_cancer$Smoking %<>%
levels() %>%
as.numeric()
period_cancer$Smoking
period_cancer$Freq %>%
levels() %>%
as.numeric()
period_cancer
str(period_cancer)
ggplot(data=period_cancer, aes(x=Freq, y=Smoking, fill=LC)) + geom_violin()
ggplot(data=period_cancer, aes(x=Freq, y=LC, fill=Freq)) + geom_violin()
ggplot(data=period_cancer, aes(x=LC, y=Freq, fill=Freq)) + geom_violin()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=Freq)) + geom_violin()
period_cancer$Smoking %<>%
levels() %>%
as.numeric()
period_no_cancer <- cancer %>%
filter(LC == "NoCancer") %>%
select(Smoking) %>%
table() %>%
as.data.frame()
period_no_cancer
period_cancer
str(period_cancer)
period_cancer$LC
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) + geom_violin()
ggplot(data=period_no_cancer, aes(x=LC, y=Smoking)) + geom_violin()
period_no_cancer <- cancer %>%
filter(LC == "NoCancer") %>%
select(Smoking) %>%
table() %>%
as.data.frame()
period_no_cancer
names(period_no_cancer)[2] <- "num"
names(period_no_cancer)[1] <- "period"
period_no_cancer
ggplot(data=period_no_cancer, aes(x=num, y=period)) + geom_violin()
period_no_cancer$Smoking %<>%
levels() %>%
as.numeric()
period_no_cancer <- cancer %>%
filter(LC == "NoCancer") %>%
select(Smoking) %>%
table() %>%
as.data.frame()
period_no_cancer$Smoking %<>%
levels() %>%
as.numeric()
period_no_cancer
str(period_no_cancer)
names(period_no_cancer)[1] <- "period"
names(period_no_cancer)[2] <- "num"
str(period_no_cancer)
period_no_cancer$period %<>%
levels() %>%
as.numeric()
ggplot(data=period_no_cancer, aes(x=num, y=period)) + geom_violin()
ggplot(data=period_cancer, aes(x=LC, y=Smoking)) + geom_violin()
period_cancer
install.packages("MASS")
library(MASS)
View(Cars93)
str(Cars93)
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) + geom_violin()
str(period_cancer)
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=num)) + geom_violin()
period_cancer
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=Freq)) + geom_violin()
ggplot(data=period_cancer, aes(x=Freq, y=Smoking, fill=Freq)) + geom_violin()
ggplot(data=period_cancer, aes(x=Freq, y=Smoking, fill=LC)) + geom_violin()
###2
period_cancer <- cancer %>%
select(Smoking, LC) %>%
as.data.frame()
cancer
cancer %>%
select(Smoking, LC)
cancer %>%
select(Smoking)
ancer %>%
select(LC)
cancer %>%
select(LC)
cancer <- read.csv("./data/lung-cancer.csv")
cancer %>%
dplyr::select(LC)
cancer %>%
dplyr::select(LC, Smoking)
###2
period_cancer <- cancer %>%
select(LC, Smoking)
###2
period_cancer <- cancer %>%
dplyr::select(LC, Smoking)
period_cancer
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) + geom_violin()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin() +
labs(x="", y="Smoking Period", fill="")
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin() +
labs(x="", y="Smoking Period", fill="") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin() +
geom_jitter(shape=16, position=position_jitter(0.2)) +
labs(x="", y="Smoking Period", fill="") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin() +
geom_jitter(shape=16, position=position_jitter(0.2), fill=LC) +
labs(x="", y="Smoking Period", fill="") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin() +
geom_jitter(shape=16, position=position_jitter(0.2), fill=LC) +
labs(x="", y="Smoking Period", fill="") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
geom_jitter(shape=16, position=position_jitter(0.2)) +
labs(x="", y="Smoking Period", fill="") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
labs(x="", y="Smoking Period", fill="") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
labs(x="", y="Smoking Period", fill="")
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
labs(x="", y="Smoking Period") +
theme(legend.position = "none") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
theme(legend.position = "none") +
labs(x="", y="Smoking Period", fill="") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
labs(x="", y="Smoking Period") +
theme(legend.position = "none") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
scale_color_manual(values = c("red", "skyblue")) +
labs(x="", y="Smoking Period") +
theme(legend.position = "none") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
scale_color_manual(values = c("red", "blue")) +
labs(x="", y="Smoking Period") +
theme(legend.position = "none") +
theme_solarized()
g <-ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
scale_color_manual(values = c("red", "blue")) +
labs(x="", y="Smoking Period") +
theme(legend.position = "none") +
theme_solarized()
ggplotly(g)
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
scale_color_manual(values = c("red", "blue")) +
labs(x="", y="Smoking Period") +
theme(legend.position = "none") +
theme_solarized()
g <-ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
scale_color_manual(values = c("red", "blue")) +
labs(x="", y="Smoking Period") +
theme(legend.position = "none") +
theme_solarized()
g
g <-ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
scale_color_manual(values = c("red", "blue")) +
labs(x="", y="Smoking Period") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
scale_color_manual(values = c("red", "blue")) +
labs(x="", y="Smoking Period") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
theme(legend.position = "none") +
scale_color_manual(values = c("red", "blue")) +
labs(x="", y="Smoking Period") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
theme(legend.position = "none") +
scale_color_manual(values = c("red", "blue")) +
theme(legend.position = "none") +
labs(x="", y="Smoking Period") +
theme_solarized()
period_cancer
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
theme(legend.position = "none") +
scale_color_manual(values = c("red", "blue")) +
theme(legend.position = "none") +
labs(x="", y="Smoking Period") +
geom_text(aes(y=LC, label=c("1", "2"))) +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
theme(legend.position = "none") +
scale_color_manual(values = c("red", "blue")) +
theme(legend.position = "none") +
labs(x="", y="Smoking Period") +
geom_text(aes(y=LC, label=LC)) +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
theme(legend.position = "none") +
scale_color_manual(values = c("red", "blue")) +
theme(legend.position = "none") +
labs(x="", y="Smoking Period") +
geom_text(aes(y=LC, label=sum(LC))) +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
theme(legend.position = "none") +
scale_color_manual(values = c("red", "blue")) +
theme(legend.position = "none") +
labs(x="", y="Smoking Period") +
geom_text(aes(y=LC, label=as.character(sum(LC)))) +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
theme(legend.position = "none") +
scale_color_manual(values = c("red", "blue")) +
theme(legend.position = "none") +
labs(x="", y="Smoking Period") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
theme(legend.position = "none") +
scale_color_manual(values = c("red", "blue")) +
theme(legend.position = "none") +
labs(x="", y="Smoking Period", fill="") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
theme(legend.position = "none") +
scale_color_manual(values = c("red", "blue")) +
labs(x="", y="Smoking Period", fill="") +
theme(legend.position = "none") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
theme(legend.position = "none") +
scale_color_manual(values = c("red", "blue")) +
theme(legend.position = "none") +
labs(x="", y="Smoking Period") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_dotplot(binaxis='y', stackdir='center', dotsize=1) +
#geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
theme(legend.position = "none") +
scale_color_manual(values = c("red", "blue")) +
theme(legend.position = "none") +
labs(x="", y="Smoking Period") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_dotplot(binaxis='y', stackdir='center', dotsize=0.5) +
#geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
theme(legend.position = "none") +
scale_color_manual(values = c("red", "blue")) +
theme(legend.position = "none") +
labs(x="", y="Smoking Period") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
theme(legend.position = "none") +
scale_color_manual(values = c("red", "blue")) +
theme(legend.position = "none") +
labs(x="", y="Smoking Period") +
theme_solarized()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
scale_color_manual(values = c("red", "blue")) +
labs(x="", y="Smoking Period") +
theme_solarized()
ggplotly(g)
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
scale_color_manual(values = c("red", "blue")) +
labs(x="", y="Smoking Period") +
theme_solarized()
#stacked barplot
ggplot(gender_data, aes(x=label, y=num, fill=gender)) +
geom_bar(stat="identity", position="stack", width=0.6) +
geom_text(aes(y=num, label=num), colour = "black", size=6, vjust=1.5) +
theme_wsj()
ggplot(gender_data, aes(x=label, y=prop, fill=gender)) +
geom_bar(stat="identity", position="stack", width=0.6) +
geom_text(aes(y=cum, label=paste0(prop*100, "%")), colour = "black", size=5, vjust=1.5) +
scale_y_continuous(labels=percent)+
theme_wsj() +
scale_y_continuous(breaks = NULL)
ggplot(gender_data, aes(x=label, y=prop, fill=gender)) +
geom_bar(stat="identity", position="stack", width=0.6) +
geom_text(aes(y=cum, label=paste0(prop*100, "%")), colour = "black", size=5, vjust=1.5) +
scale_y_continuous(labels=percent)+
theme_wsj()
#stacked barplot
ggplot(gender_data, aes(x=label, y=num, fill=gender)) +
geom_bar(stat="identity", position="stack", width=0.6) +
geom_text(aes(y=num, label=num), colour = "black", size=6, vjust=1.5) +
theme_wsj()
gender_data
num
gender_data
###3
male_cancer <- cancer %>%
filter(LC=="LungCancer" & Sex == "Male") %>%
nrow()
female_cancer <- cancer %>%
filter(LC == "LungCancer", Sex == "Female") %>%
nrow()
male_no_cancer <-cancer %>%
filter(LC == "NoCancer" & Sex == "Male") %>%
nrow()
female_no_cancer <- cancer %>%
filter(LC == "NoCancer" & Sex == "Female") %>%
nrow()
prop <- c(male_cancer/(male_cancer+female_cancer),
female_cancer/(male_cancer+female_cancer),
male_no_cancer/(male_no_cancer+female_no_cancer),
female_no_cancer/(male_no_cancer+female_no_cancer)) %>%
round(., digit=2)
gender_data <- data.frame(gender = rep(c("male", "female"), times=2) %>% factor(),
num = c(male_cancer, female_cancer, male_no_cancer, female_no_cancer),
cum_num = c(male_cancer, male_cancer+female_cancer, male_no_cancer, male_no_cancer+female_no_cancer),
prop = prop,
cum_prop = c(cumsum(prop[c(1,2)]), cumsum(prop[c(3,4)])),
label = rep(c("LungCancer", "NoCancer"), each=2) %>% factor())
gender_data
##stacked barplot
#num
ggplot(gender_data, aes(x=label, y=num, fill=gender)) +
geom_bar(stat="identity", position="stack", width=0.6) +
geom_text(aes(y=cum_num, label=num), colour = "black", size=6, vjust=1.5) +
theme_wsj()
#mosaic plot
g1 <- ggplot(gender_data) +
geom_mosaic(aes(weight=num, x=product(gender, label), fill=label)) +
theme_solarized() +
labs(x="", y="", fill="")
g2 <- g1 + geom_text(data = layer_data(g1, 1) %>%
select(xmin:ymax) %>%
mutate(m.x = (xmin + xmax)/2, m.y =  (ymin + ymax)/2) %>%
select(m.x, m.y)  %>%
mutate(string = c(12, 37, 24, 74)),
aes(x = m.x, y = m.y, label = string),
size = 6)
g2 <- g1 + geom_text(data = layer_data(g1, 1) %>%
dplyr::select(xmin:ymax) %>%
mutate(m.x = (xmin + xmax)/2, m.y =  (ymin + ymax)/2) %>%
select(m.x, m.y)  %>%
mutate(string = c(12, 37, 24, 74)),
aes(x = m.x, y = m.y, label = string),
size = 6)
g2 <- g1 + geom_text(data = layer_data(g1, 1) %>%
dplyr::select(xmin:ymax) %>%
mutate(m.x = (xmin + xmax)/2, m.y =  (ymin + ymax)/2) %>%
dplyr::select(m.x, m.y)  %>%
mutate(string = c(12, 37, 24, 74)),
aes(x = m.x, y = m.y, label = string),
size = 6)
g2
ggplotly(g2)
ggplot(gender_data) +
geom_mosaic(aes(weight=num, x=product(gender, label), fill=label)) +
theme_solarized() +
labs(x="", y="", fill="") +
###4
age_cancer <- cancer %>%
filter(LC == "LungCancer") %>%
select(Age) %>%
table() %>%
as.data.frame()
ggplot(gender_data) +
geom_mosaic(aes(weight=num, x=product(gender, label), fill=label)) +
theme_solarized() +
labs(x="", y="", fill="") +
###4
age_cancer <- cancer %>%
filter(LC == "LungCancer") %>%
select(Age) %>%
table() %>%
as.data.frame()
ggplot(gender_data) +
geom_mosaic(aes(weight=num, x=product(gender, label), fill=label)) +
theme_solarized() +
labs(x="", y="", fill="")
