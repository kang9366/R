sep_20 <- read_xlsx(paste(src_dir, "/", src_file[20], sep=""), col_names=T) %>%
t() %>%
data.frame()
oct_20 <- read_xlsx(paste(src_dir, "/", src_file[21], sep=""), col_names=T) %>%
t() %>%
data.frame()
nov_20 <- read_xlsx(paste(src_dir, "/", src_file[22], sep=""), col_types = "guess") %>%
t() %>%
data.frame()
data_19 <- data.frame(jan_19[2:length(jan_19), 1],
feb_19[2:length(feb_19), 1])
nov_20[2:length(nov_20), 1]
data_19
data_19 <- data.frame("1월" = jan_19[2:length(jan_19), 1],
"2월" = feb_19[2:length(feb_19), 1])
data_19
data_19 <- data.frame("1월" = jan_19[2:length(jan_19), 1],
"2월" = feb_19[2:length(feb_19), 1],
"3월" = mar_19[2:length(mar_19), 1],
"4월" = apr_19[2:length(apr_19), 1],
"5월" = may_19[2:length(may_19), 1],
"6월" = jun_19[2:length(jun19), 1],
"7월" = july_19[2:length(july_19), 1],
"8월" = aug_19[2:length(aug19), 1],
"9월" = sep_19[2:length(sep_19), 1],
"10월" = oct_19[2:length(oct_19), 1],
"11월" = nov_19[2:length(feb_19), 1])
data_19 <- data.frame("1월" = jan_19[2:length(jan_19), 1],
"2월" = feb_19[2:length(feb_19), 1],
"3월" = mar_19[2:length(mar_19), 1],
"4월" = apr_19[2:length(apr_19), 1],
"5월" = may_19[2:length(may_19), 1],
"6월" = jun_19[2:length(jun_19), 1],
"7월" = july_19[2:length(july_19), 1],
"8월" = aug_19[2:length(aug19), 1],
"9월" = sep_19[2:length(sep_19), 1],
"10월" = oct_19[2:length(oct_19), 1],
"11월" = nov_19[2:length(feb_19), 1])
data_19 <- data.frame("1월" = jan_19[2:length(jan_19), 1],
"2월" = feb_19[2:length(feb_19), 1],
"3월" = mar_19[2:length(mar_19), 1],
"4월" = apr_19[2:length(apr_19), 1],
"5월" = may_19[2:length(may_19), 1],
"6월" = jun_19[2:length(jun_19), 1],
"7월" = july_19[2:length(july_19), 1],
"8월" = aug_19[2:length(aug_19), 1],
"9월" = sep_19[2:length(sep_19), 1],
"10월" = oct_19[2:length(oct_19), 1],
"11월" = nov_19[2:length(feb_19), 1])
data_19
View(data_19)
data_19 <- data.frame("1월" = mean(jan_19[2:length(jan_19)), 1],
"2월" = mean(feb_19[2:length(feb_19)), 1],
"3월" = mean(mar_19[2:length(mar_19)), 1],
"4월" = mean(apr_19[2:length(apr_19)), 1],
"5월" = mean(may_19[2:length(may_19)), 1],
"6월" = mean(jun_19[2:length(jun_19)), 1],
"7월" = mean(july_19[2:length(july_19)), 1],
"8월" = mean(aug_19[2:length(aug_19)), 1],
"9월" = mean(sep_19[2:length(sep_19)), 1],
"10월" = mean(oct_19[2:length(oct_19)), 1],
"11월" = mean(nov_19[2:length(feb_19)), 1])
data_19 <- data.frame("1월" = mean(jan_19[2:length(jan_19), 1]),
"2월" = mean(feb_19[2:length(feb_19), 1]),
"3월" = mean(mar_19[2:length(mar_19), 1]),
"4월" = mean(apr_19[2:length(apr_19), 1]),
"5월" = mean(may_19[2:length(may_19), 1]),
"6월" = mean(jun_19[2:length(jun_19), 1]),
"7월" = mean(july_19[2:length(july_19), 1]),
"8월" = mean(aug_19[2:length(aug_19), 1]),
"9월" = mean(sep_19[2:length(sep_19), 1]),
"10월" = mean(oct_19[2:length(oct_19), 1]),
"11월" = mean(nov_19[2:length(feb_19), 1]))
View(data_19)
mean_19 <- c(mean(data_19$X1월),
mean(data_19$X2월),
mean(data_19$X3월),
mean(data_19$X4월),
mean(data_19$X5월),
mean(data_19$X6월),
mean(data_19$X7월),
mean(data_19$X8월),
mean(data_19$X9월),
mean(data_19$X10월),
mean(data_19$X11월))
mean_19
data_19$X1월
jan_19[2:length(jan_19), 1]
str(data_19)
str(nov_20)
as.numeric(jan_19[2:length(jan_19), 1])
data_19 <- data.frame("1월" = as.numeric(jan_19[2:length(jan_19), 1]),
"2월" = as.numeric(feb_19[2:length(feb_19), 1]),
"3월" = as.numeric(mar_19[2:length(mar_19), 1]),
"4월" = as.numeric(apr_19[2:length(apr_19), 1]),
"5월" = as.numeric(may_19[2:length(may_19), 1]),
"6월" = as.numeric(jun_19[2:length(jun_19), 1]),
"7월" = as.numeric(july_19[2:length(july_19), 1]),
"8월" = as.numeric(aug_19[2:length(aug_19), 1]),
"9월" = as.numeric(sep_19[2:length(sep_19), 1]),
"10월" = as.numeric(oct_19[2:length(oct_19), 1]),
"11월" = as.numeric(nov_19[2:length(feb_19), 1]))
data_19
mean_19 <- c(mean(data_19$X1월),
mean(data_19$X2월),
mean(data_19$X3월),
mean(data_19$X4월),
mean(data_19$X5월),
mean(data_19$X6월),
mean(data_19$X7월),
mean(data_19$X8월),
mean(data_19$X9월),
mean(data_19$X10월),
mean(data_19$X11월))
mean_19
barplot(mean_19)
mean_20 <- c(mean(data_20$X1월),
mean(data_20$X2월),
mean(data_20$X3월),
mean(data_20$X4월),
mean(data_20$X5월),
mean(data_20$X6월),
mean(data_20$X7월),
mean(data_20$X8월),
mean(data_20$X9월),
mean(data_20$X10월),
mean(data_20$X11월))
data_20 <- data.frame("1월" = as.numeric(jan_20[2:length(jan_20), 1]),
"2월" = as.numeric(feb_20[2:length(feb_20), 1]),
"3월" = as.numeric(mar_20[2:length(mar_20), 1]),
"4월" = as.numeric(apr_20[2:length(apr_20), 1]),
"5월" = as.numeric(may_20[2:length(may_20), 1]),
"6월" = as.numeric(jun_20[2:length(jun_20), 1]),
"7월" = as.numeric(july_20[2:length(july_20), 1]),
"8월" = as.numeric(aug_20[2:length(aug_20), 1]),
"9월" = as.numeric(sep_20[2:length(sep_20), 1]),
"10월" = as.numeric(oct_20[2:length(oct_20), 1]),
"11월" = as.numeric(nov_20[2:length(feb_20), 1]))
data_20 <- data.frame("1월" = as.numeric(jan_20[2:length(jan_20), 1]),
"2월" = as.numeric(feb_20[2:length(feb_20), 1]),
"3월" = as.numeric(mar_20[2:length(mar_20), 1]),
"4월" = as.numeric(apr_20[2:length(apr_20), 1]),
"5월" = as.numeric(may_20[2:length(may_20), 1]),
"6월" = as.numeric(jun_20[2:length(jun_20), 1]),
"7월" = as.numeric(july_20[2:length(july_20), 1]),
"8월" = as.numeric(aug_20[2:length(aug_20), 1]),
"9월" = as.numeric(sep_20[2:length(sep_20), 1]),
"10월" = as.numeric(oct_20[2:length(oct_20), 1]),
"11월" = as.numeric(nov_20[2:length(feb_20), 1]))
jan_20 <- read_xlsx(paste(src_dir, "/", src_file[12], sep=""), col_names=T) %>%
t() %>%
data.frame()
feb_20 <- read_xlsx(paste(src_dir, "/", src_file[13], sep=""), col_names=T) %>%
t() %>%
data.frame()
data_20 <- data.frame("1월" = as.numeric(jan_20[2:length(jan_20), 1]),
"2월" = as.numeric(feb_20[2:length(feb_20), 1]),
"3월" = as.numeric(mar_20[2:length(mar_20), 1]),
"4월" = as.numeric(apr_20[2:length(apr_20), 1]),
"5월" = as.numeric(may_20[2:length(may_20), 1]),
"6월" = as.numeric(jun_20[2:length(jun_20), 1]),
"7월" = as.numeric(july_20[2:length(july_20), 1]),
"8월" = as.numeric(aug_20[2:length(aug_20), 1]),
"9월" = as.numeric(sep_20[2:length(sep_20), 1]),
"10월" = as.numeric(oct_20[2:length(oct_20), 1]),
"11월" = as.numeric(nov_20[2:length(feb_20), 1]))
mean_20 <- c(mean(data_20$X1월),
mean(data_20$X2월),
mean(data_20$X3월),
mean(data_20$X4월),
mean(data_20$X5월),
mean(data_20$X6월),
mean(data_20$X7월),
mean(data_20$X8월),
mean(data_20$X9월),
mean(data_20$X10월),
mean(data_20$X11월))
barplot(mean_20)
par(mfrow=c(1,1))
barplot(mean_19)
barplot(mean_20)
par(mfrow=c(1,1))
barplot(mean_19)
barplot(mean_20)
par(mfrow=c(2,1))
barplot(mean_19)
barplot(mean_20)
par(mfrow=c(1,2))
barplot(mean_19)
barplot(mean_20)
barplot(mean_19, names=c("1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "10월", "11월"))
barplot(mean_19, names=c("1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월"))
par(mfrow=c(1,2))
barplot(mean_19, names=c("1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월"))
library(RColorBrewer)
barplot(mean_19, names=c("1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월"),
main="2019년 서울시 미세먼지 월 별 평균", col=brewer.pal(11, "Set2"))
par(mfrow=c(1,2))
barplot(mean_19, names=c("1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월"),
main="2019년 서울시 미세먼지 월 별 평균", col=brewer.pal(11, "Set2"))
barplot(mean_20, names=c("1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월"),
main="2020년 서울시 미세먼지 월 별 평균", col=brewer.pal(11, "Set2"))
barplot(mean_19, names=c("1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월"),
main="2019년 서울시 미세먼지 월 별 평균", col=brewer.pal(11, "Set2"), ylim=c(0,80))
barplot(mean_19, names=c("1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월"),
main="2019년 서울시 미세먼지 월 별 평균", col=brewer.pal(11, "Set2"), ylim=c(0, 80))
barplot(mean_20, names=c("1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월"),
main="2020년 서울시 미세먼지 월 별 평균", col=brewer.pal(11, "Set2"), ylim=c(0, 80))
par(mfrow=c(1,2))
barplot(mean_19, names=c("1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월"),
main="2019년 서울시 미세먼지 월 별 평균", col=brewer.pal(11, "Set2"), ylim=c(0, 80))
barplot(mean_20, names=c("1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월"),
main="2020년 서울시 미세먼지 월 별 평균", col=brewer.pal(11, "Set2"), ylim=c(0, 80))
load("~/.RData")
install.packages("rvest")
setwd("~/Desktop/R/Data visualization")
library(dplyr)
library(magrittr)
library(ggplot2)
library(ggthemes)
library(scales)
library(plotly)
library(ggmosaic)
cancer <- read.csv("./data/lung-cancer.csv")
View(cancer)
str(cancer)
###1
cancer_data <- table(cancer$LC) %>%
as.data.frame()
names(cancer_data)[1] <- "type"
names(cancer_data)[2] <- "num"
cancer_data
ggplot(cancer_data, aes(x=type, y=num, fill=type)) +
geom_bar(stat="identity", width=0.5) +
theme_wsj() +
scale_colour_wsj("colors6") +
theme(legend.position = "none") +
geom_text(aes(y=num, label = num), colour="black", size=5.5, vjust=0.5)
###2
period_cancer <- cancer %>%
dplyr::select(LC, Smoking)
period_cancer <- cancer %>%
filter(LC == "LungCancer") %>%
select(Smoking) %>%
table() %>%
as.data.frame()
###2
period_cancer <- cancer %>%
select(LC, Smoking)
period_cancer <- cancer %>%
filter(LC == "LungCancer") %>%
select(Smoking) %>%
table() %>%
as.data.frame()
period_cancer$Smoking %<>%
levels() %>%
as.numeric()
period_cancer
###2
period_cancer <- cancer %>%
filter(LC == "LungCancer") %>%
select(Smoking) %>%
table() %>%
as.data.frame()
names(period_cancer)[1] <- "period"
names(period_cancer)[2] <- "num"
period_cancer$Smoking %<>%
levels() %>%
as.numeric()
period_cancer
period_cancer$period %<>%
levels() %>%
as.numeric()
period_cancer$num %>%
levels() %>%
as.numeric()
period_cancer
str(period_cancer)
###2
period_cancer <- cancer %>%
filter(LC == "LungCancer") %>%
select(Smoking) %>%
table() %>%
as.data.frame()
str(period_cancer)
period_cancer$period %<>%
levels() %>%
as.numeric()
names(period_cancer)[1] <- "period"
names(period_cancer)[2] <- "num"
period_cancer$period %<>%
levels() %>%
as.numeric()
period_no_cancer <- cancer %>%
filter(LC == "NoCancer") %>%
select(Smoking) %>%
table() %>%
as.data.frame()
names(period_no_cancer)[1] <- "period"
names(period_no_cancer)[2] <- "num"
period_no_cancer$period %<>%
levels() %>%
as.numeric()
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
scale_color_manual(values = c("red", "blue")) +
labs(x="", y="Smoking Period") +
theme_solarized()
###2
period_cancer <- cancer %>%
select(LC, Smoking)
period_cancer
ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
scale_color_manual(values = c("red", "blue")) +
labs(x="", y="Smoking Period") +
theme_solarized()
g <- ggplot(data=period_cancer, aes(x=LC, y=Smoking, fill=LC)) +
geom_violin(alpha=0.6) +
theme(legend.position = "none") +
geom_jitter(aes(color=LC), shape=16, position=position_jitter(0.2)) +
scale_color_manual(values = c("red", "blue")) +
labs(x="", y="Smoking Period") +
theme_solarized()
ggplotly(g)
###3
male_cancer <- cancer %>%
filter(LC=="LungCancer" & Sex == "Male") %>%
nrow()
female_cancer <- cancer %>%
filter(LC == "LungCancer", Sex == "Female") %>%
nrow()
male_no_cancer <-cancer %>%
filter(LC == "NoCancer" & Sex == "Male") %>%
nrow()
female_no_cancer <- cancer %>%
filter(LC == "NoCancer" & Sex == "Female") %>%
nrow()
prop <- c(male_cancer/(male_cancer+female_cancer),
female_cancer/(male_cancer+female_cancer),
male_no_cancer/(male_no_cancer+female_no_cancer),
female_no_cancer/(male_no_cancer+female_no_cancer)) %>%
round(., digit=2)
gender_data <- data.frame(gender = rep(c("male", "female"), times=2) %>% factor(),
num = c(male_cancer, female_cancer, male_no_cancer, female_no_cancer),
cum_num = c(male_cancer, male_cancer+female_cancer, male_no_cancer, male_no_cancer+female_no_cancer),
prop = prop,
cum_prop = c(cumsum(prop[c(1,2)]), cumsum(prop[c(3,4)])),
label = rep(c("LungCancer", "NoCancer"), each=2) %>% factor())
gender_data
gender_data <- data.frame(gender = rep(c("male", "female"), times=2) %>% factor(),
num = c(male_cancer, female_cancer, male_no_cancer, female_no_cancer),
cum_num = c(male_cancer, male_cancer+female_cancer, male_no_cancer, male_no_cancer+female_no_cancer),
prop = prop,
cum_prop = c(cumsum(prop[c(1,2)]), cumsum(prop[c(3,4)])),
label = rep(c("LungCancer", "NoCancer"), each=2) %>% factor())
gender_data <- data.frame(gender = rep(c("male", "female"), times=2) %>% factor(),
num = c(male_cancer, female_cancer, male_no_cancer, female_no_cancer),
cum_num = c(male_cancer, male_cancer+female_cancer, male_no_cancer, male_no_cancer+female_no_cancer),
prop = prop,
cum_prop = c(cumsum(prop[c(1,2)]), cumsum(prop[c(3,4)])),
LC = rep(c("LungCancer", "NoCancer"), each=2) %>% factor())
gender_data
##stacked barplot
#num
ggplot(gender_data, aes(x=LC, y=num, fill=gender)) +
geom_bar(stat="identity", position="stack", width=0.6) +
geom_text(aes(y=cum_num, label=num), colour = "black", size=6, vjust=1.5) +
theme_wsj()
#proportion
ggplot(gender_data, aes(x=LC, y=prop, fill=gender)) +
geom_bar(stat="identity", position="stack", width=0.6) +
geom_text(aes(y=cum_prop, label=paste0(prop*100, "%")), colour = "black", size=5, vjust=1.5) +
scale_y_continuous(labels=percent)+
theme_wsj()
#mosaic plot
g1 <- ggplot(gender_data) +
geom_mosaic(aes(weight=num, x=product(gender, LC), fill=LC)) +
theme_solarized() +
labs(x="", y="", fill="")
g2 <- g1 + geom_text(data = layer_data(g1, 1) %>%
select(xmin:ymax) %>%
mutate(m.x = (xmin + xmax)/2, m.y =  (ymin + ymax)/2) %>%
select(m.x, m.y)  %>%
mutate(string = c(12, 37, 24, 74)),
aes(x = m.x, y = m.y, label = string),
size = 6)
g2
plotly(g2)
ggplotly(g2)
#mosaic plot
g <- ggplot(gender_data) +
geom_mosaic(aes(weight=num, x=product(gender, LC), fill=LC)) +
theme_solarized() +
labs(x="", y="", fill="") +
geom_text(data = layer_data(g1, 1) %>%
select(xmin:ymax) %>%
mutate(m.x = (xmin + xmax)/2, m.y =  (ymin + ymax)/2) %>%
select(m.x, m.y)  %>%
mutate(string = c(12, 37, 24, 74)),
aes(x = m.x, y = m.y, label = string),
size = 6)
g
###4
age_cancer <- cancer %>%
filter(LC == "LungCancer") %>%
select(Age) %>%
table() %>%
as.data.frame()
age_no_cancer <- cancer %>%
filter(LC == "NoCancer") %>%
select(Age) %>%
table() %>%
as.data.frame()
names(age_cancer)[1] <- "age"
names(age_no_cancer)[1] <- "age"
names(age_cancer)[2] <- "num"
names(age_no_cancer)[2] <- "num"
#density plot
ggplot() +
geom_density(data=age_no_cancer, aes(x=age), fill="#BAD252", alpha=0.5) +
geom_density(data=age_cancer, aes(x=age), fill="#E0B0BC", alpha=0.5)
ggplot(age_cancer, aes(x=age)) +
geom_density(fill="#E0B0BC", alpha=0.5) +
theme_wsj()
ggplot(age_no_cancer, aes(x=age)) +
geom_density(fill="#E0B0BC", alpha=0.5) +
theme_wsj()
age_cancer$age %<>%
levels(.) %>%
as.numeric()
age_no_cancer$age %<>%
levels(.) %>%
as.numeric()
#linear plot
ggplot(age_cancer, aes(x=age, y=num)) +
geom_area(fill="#69b3a2", alpha=0.5) +
geom_line(aes(group=1)) +
geom_point()
ggplot(age_no_cancer, aes(x=age, y=num)) +
geom_area(fill="#BAD252", alpha=0.5) +
geom_line(aes(group=1)) +
geom_point()
g <- ggplot() +
geom_area(data=age_no_cancer, aes(x=age, y=num, fill="NoCancer"), alpha=0.5, colour="#BAD252") +
geom_line(data=age_no_cancer, aes(x=age, y=num, group=1)) +
geom_area(data=age_cancer, aes(x=age, y=num, fill="LungCancer"), alpha=0.5, colour="#ED5D47") +
geom_line(data=age_cancer, aes(x=age, y=num, group=1)) +
theme_solarized() +
labs(fill="") +
scale_x_continuous(breaks=seq(37, 67, 1)) +
scale_y_continuous(breaks=seq(1, 12, 2))
ggplotly(g)
###4
age_cancer <- cancer %>%
filter(LC == "LungCancer") %>%
select(Age) %>%
table() %>%
as.data.frame()
names(age_cancer)[1] <- "age"
names(age_cancer)[2] <- "freq"
age_cancer
age_no_cancer <- cancer %>%
filter(LC == "NoCancer") %>%
select(Age) %>%
table() %>%
as.data.frame()
names(age_no_cancer)[1] <- "age"
names(age_no_cancer)[2] <- "freq"
age_no_cancer
g <- ggplot() +
geom_area(data=age_no_cancer, aes(x=age, y=num, fill="NoCancer"), alpha=0.5, colour="#BAD252") +
geom_line(data=age_no_cancer, aes(x=age, y=num, group=1)) +
geom_area(data=age_cancer, aes(x=age, y=num, fill="LungCancer"), alpha=0.5, colour="#ED5D47") +
geom_line(data=age_cancer, aes(x=age, y=num, group=1)) +
theme_solarized() +
labs(fill="") +
scale_x_continuous(breaks=seq(37, 67, 1)) +
scale_y_continuous(breaks=seq(1, 12, 2))
ggplotly(g)
g <- ggplot() +
geom_area(data=age_no_cancer, aes(x=age, y=freq, fill="NoCancer"), alpha=0.5, colour="#BAD252") +
geom_line(data=age_no_cancer, aes(x=age, y=freq, group=1)) +
geom_area(data=age_cancer, aes(x=age, y=freq, fill="LungCancer"), alpha=0.5, colour="#ED5D47") +
geom_line(data=age_cancer, aes(x=age, y=freq, group=1)) +
theme_solarized() +
labs(fill="") +
scale_x_continuous(breaks=seq(37, 67, 1)) +
scale_y_continuous(breaks=seq(1, 12, 2))
ggplotly(g)
g
age_cancer$age %<>%
levels(.) %>%
as.numeric()
age_no_cancer$age %<>%
levels(.) %>%
as.numeric()
g <- ggplot() +
geom_area(data=age_no_cancer, aes(x=age, y=freq, fill="NoCancer"), alpha=0.5, colour="#BAD252") +
geom_line(data=age_no_cancer, aes(x=age, y=freq, group=1)) +
geom_area(data=age_cancer, aes(x=age, y=freq, fill="LungCancer"), alpha=0.5, colour="#ED5D47") +
geom_line(data=age_cancer, aes(x=age, y=freq, group=1)) +
theme_solarized() +
labs(fill="") +
scale_x_continuous(breaks=seq(37, 67, 1)) +
scale_y_continuous(breaks=seq(1, 12, 2))
g
ggplotly(g)
